CREATE DATABASE IF NOT EXISTS ODATA_SAMPLE;
USE ODATA_SAMPLE;
CREATE TABLE IF NOT EXISTS Manufacturer (
	manufacturerId BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
	name VARCHAR(100),
	street VARCHAR(100),
	city VARCHAR(100),
	zipCode VARCHAR(100),
	country VARCHAR(100),
	updated DATE
);

CREATE TABLE IF NOT EXISTS Car (
	carId BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT ,
	model VARCHAR(100),
	currency VARCHAR(100),
	price REAL,
	modelYear VARCHAR(100),
	imagePath VARCHAR(100),
	updated DATE,
	manufacturerId BIGINT NOT NULL,
	FOREIGN KEY (manufacturerId) REFERENCES Manufacturer (manufacturerId)
);

CREATE TABLE IF NOT EXISTS users (
  user_name VARCHAR(20) NOT NULL PRIMARY KEY,
  user_pass VARCHAR(20) NOT NULL
);

CREATE TABLE IF NOT EXISTS roles (
  role_name VARCHAR(20) NOT NULL PRIMARY KEY
);

CREATE TABLE IF NOT EXISTS user_roles(
  user_name VARCHAR(20) NOT NULL,
  role_name VARCHAR(20) NOT NULL,
  PRIMARY KEY (user_name, role_name)
);

CREATE TABLE IF NOT EXISTS user_permissions (
  user_name VARCHAR(20) NOT NULL,
  entity VARCHAR(40) NOT NULL,
  permissions VARCHAR(4) NOT NULL,
  PRIMARY KEY (user_name, entity)
);

CREATE TABLE IF NOT EXISTS audit_log (
  ts TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  entity VARCHAR(40) NOT NULL,
  user_name VARCHAR(20) NOT NULL,
  operation VARCHAR(1) NOT NULL
);

